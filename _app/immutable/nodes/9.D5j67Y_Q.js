import{g as N}from"../chunks/entry.DCaMQVoQ.js";import{a as S,b as $,w as P,g as U}from"../chunks/api.DDDsSy4Q.js";import{e as B}from"../chunks/index.CDUxX0v-.js";import"../chunks/disclose-version.CVLrmm-c.js";import{R as k,N as b,T as x,O as i,ab as _,a8 as W,P as h,Q as y,aM as z,ao as L,aF as Q,t as M,aB as R}from"../chunks/index.CbWQdyPD.js";import{h as Y}from"../chunks/svelte-head.DlRxUE2U.js";import{c as j,a as v,t as w}from"../chunks/template.FARQGre2.js";import{s as G,i as q,a as J,b as D}from"../chunks/store.zYOmaikO.js";import{e as K,i as V}from"../chunks/each.8C-LENRi.js";import{r as X}from"../chunks/routes.LLz7mK1U.js";import{i as Z}from"../chunks/legacy.Cuu4uX5Q.js";import{t as I}from"../chunks/SvelteToast.svelte_svelte_type_style_lang.B0Rm7KC1.js";import{H as ee}from"../chunks/Header.q0CrcpGa.js";import{T as te,a as ae,M as oe}from"../chunks/Menu.DitRikhZ.js";import{p as A,a as re}from"../chunks/props.BwWGETsP.js";import{i as se}from"../chunks/auth.B2SmrfAG.js";import{S as ne}from"../chunks/SignIn.CN-2JlbK.js";import{T as ie,B as de}from"../chunks/Button.BHvtqtSM.js";import{f as me}from"../chunks/strings.CBcZxANx.js";(function(){try{var t=typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},e=new t.Error().stack;e&&(t._sentryDebugIds=t._sentryDebugIds||{},t._sentryDebugIds[e]="88ba5daf-464c-455e-8a68-a748023519d9",t._sentryDebugIdIdentifier="sentry-dbid-88ba5daf-464c-455e-8a68-a748023519d9")}catch{}})();const ce=async t=>{const e=await S.getTree(t);return e.status!==200&&B(404),$(e.data.users),e.data},le=async t=>{const e=await S.getTreeComments(t);return e.status!==200&&B(404),$(e.data.users),e.data.comments},E=async({params:t})=>{const e=t.id;return{id:e,tree:await ce(e),comments:await le(e)}},ue=E?P(E):void 0,Pe=Object.freeze(Object.defineProperty({__proto__:null,load:ue},Symbol.toStringTag,{value:"Module"}));function ve(t,e){let a=A(e,"value",12,"");ie(t,{label:"Comment",multiline:!0,hint:"Some hints or suggested edits.",get value(){return a()},set value(d){a(d)},$$legacy:!0})}var fe=w('<p>Would you like to add a comment?</p> <!> <div class="buttons"><!></div>',1),pe=w("<p>You need to be authenticated to add comments.</p> <!>",1);function ge(t,e){k(e,!0);const a=G(),d=()=>J(se,"$isAuthenticated",a);let m=z("");const c=()=>{e.onSubmit(_(m))};var s=j(),f=b(s);{var u=n=>{var l=fe(),g=i(b(l),2);ve(g,{get value(){return _(m)},set value(o){W(m,re(o))}});var C=i(g,2),T=h(C),r=L(()=>!_(m));de(T,{onClick:c,label:"Submit comment",get disabled(){return _(r)}}),y(C),v(n,l)},p=n=>{var l=pe(),g=i(b(l),2);ne(g,{}),v(n,l)};q(f,n=>{d()?n(u):n(p,!1)})}v(t,s),x()}var _e=w('<div class="comment svelte-4a5rpe"><blockquote class="svelte-4a5rpe"> </blockquote> <div class="meta svelte-4a5rpe"> </div></div>');function be(t,e){k(e,!1);let a=A(e,"comment",8);const d=Q(U)(a().added_by),m=me(a().added_at);Z();var c=_e(),s=h(c),f=h(s,!0);y(s);var u=i(s,2),p=h(u);y(u),y(c),M(()=>{D(f,a().message),D(p,`${m??""} Â· ${d.name??""}`)}),v(t,c),x()}var he=w("<p>No comments for this tree yet.</p>"),ye=w('<!> <!> <!> <!> <div class="container svelte-11j1l8y"><!> <!></div>',1);function Ue(t,e){k(e,!0);const a=e.data.tree,d=e.data.comments,m=r=>{S.addComment(a.id,r).then(o=>{o.status>=200&&o.status<300?(I.push("Comment added."),N(X.treeDetails(a.id))):(console.info(`Error ${o.status} adding a comment.`),I.push("Error adding comment."))}).catch(o=>{console.error("Exception while adding a comment.",o),I.push("Error adding comment.")})};var c=ye();Y(r=>{M(()=>R.title=`${a.species??""} - Details`)});var s=b(c);ee(s,{title:"Tree"});var f=i(s,2);te(f,{get title(){return a.species}});var u=i(f,2);ae(u,{get tree(){return a.id},active:"comments"});var p=i(u,2);oe(p,{get id(){return a.id}});var n=i(p,2),l=h(n);{var g=r=>{var o=j(),O=b(o);K(O,17,()=>d,V,(F,H)=>{be(F,{get comment(){return _(H)}})}),v(r,o)},C=r=>{var o=he();v(r,o)};q(l,r=>{d.length>0?r(g):r(C,!1)})}var T=i(l,2);ge(T,{onSubmit:m}),y(n),v(t,c),x()}export{Ue as component,Pe as universal};
//# sourceMappingURL=9.D5j67Y_Q.js.map
