import"../chunks/entry.DamMg6M4.js";import{w as oe,a as ie}from"../chunks/api.DH6G1KJX.js";import"../chunks/disclose-version.BOOGp7aG.js";import{h as S,a as ne,i as le,b as fe,aK as ce,w as E,q as ve,af as G,K,J as R,an as J,aw as W,aL as B,n as A,c as z,p as H,aM as de,d as me,a2 as ue,T as j,P as b,R as m,U as F,N as T,a5 as x,t as D,O as I,aC as pe,aD as _e,ad as V}from"../chunks/runtime.CtiHPiMQ.js";import{h as he}from"../chunks/svelte-head.x_BKoNAn.js";import{a as h,t as k,c as Z,d as X}from"../chunks/template.DiPiOMh4.js";import{p as Y,a as be}from"../chunks/props.DuH4ijTn.js";import{i as q,b as $,s as ge,a as ee}from"../chunks/store.BQe_qpk7.js";import{H as ye}from"../chunks/Header.CrC-9djY.js";import{M as we}from"../chunks/Map.Dnw5WeSq.js";import"../chunks/legacy.EuuREXvg.js";import{s as O}from"../chunks/attributes.-Vol7yKi.js";import{e as Ce}from"../chunks/events.GW5uPCd5.js";import{i as xe}from"../chunks/lifecycle.DWpdpiEa.js";import{C as De}from"../chunks/CloseIcon.B1MB9kDO.js";import{e as Ie,i as ke}from"../chunks/each.DLlErfFR.js";import{r as U}from"../chunks/routes.CWg3z6TI.js";import{f as Me,s as Te}from"../chunks/trees.2G_AVlcC.js";import{w as Ne,d as te}from"../chunks/index.jN6F8YEW.js";import{D as Pe}from"../chunks/constants.BpZ2e0hC.js";import{l as re}from"../chunks/auth.yU1hDRkp.js";(function(){try{var e=typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},s=new e.Error().stack;s&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[s]="54acac3d-8f24-403e-a83f-0e7b96659b5d",e._sentryDebugIdIdentifier="sentry-dbid-54acac3d-8f24-403e-a83f-0e7b96659b5d")}catch{}})();const L=0,M=1,Q=2;function Se(e,s,o,w,g){S&&ne();var f=e,d=le(),y=ue,i=G,c,a,t,u=(d?K:R)(void 0),v=(d?K:R)(void 0),p=!1;function r(n,_){p=!0,_&&(J(l),W(l),B(y));try{n===L&&o&&(c?A(c):c=z(()=>o(f))),n===M&&w&&(a?A(a):a=z(()=>w(f,u))),n===Q&&g&&(t?A(t):t=z(()=>g(f,v))),n!==L&&c&&H(c,()=>c=null),n!==M&&a&&H(a,()=>a=null),n!==Q&&t&&H(t,()=>t=null)}finally{_&&(B(null),W(null),J(null),de())}}var l=fe(()=>{if(i!==(i=s())){if(ce(i)){var n=i;p=!1,n.then(_=>{n===i&&(E(u,_),r(M,!0))},_=>{if(n===i)throw E(v,_),r(Q,!0),v.v}),S||ve(()=>{p||r(L,!0)})}else E(u,i),r(M,!1);return()=>i=G}});S&&(f=me)}const ae=({url:e})=>({searchQuery:e.searchParams.get("q")}),Ee=ae?oe(ae):void 0,fa=Object.freeze(Object.defineProperty({__proto__:null,load:Ee},Symbol.toStringTag,{value:"Module"}));var Ae=k('<div><a class="svelte-5k02eh"><img alt="See how good is this tree." class="svelte-5k02eh"></a></div>'),ze=k('<div class="images svelte-5k02eh"></div>'),He=k('<div class="gallery svelte-5k02eh"><!></div>');function Le(e,s){j(s,!0);var o=He(),w=b(o);Se(w,()=>ie.getTree(s.tree.id),null,(g,f)=>{var d=Z(),y=T(d);{var i=a=>{var t=X("Failed to load photos.");h(a,t)},c=a=>{var t=Z(),u=T(t);{var v=r=>{var l=X("No images for this tree.");h(r,l)},p=r=>{var l=ze();Ie(l,21,()=>x(f).data.files,ke,(n,_)=>{var C=Ae(),P=b(C);D(()=>O(P,"href",U.treeDetails(s.tree.id)));var se=b(P);D(()=>O(se,"src",U.file(x(_).small_id))),m(P),m(C),h(n,C)}),m(l),h(r,l)};q(u,r=>{x(f).data.files.length==0?r(v):r(p,!1)},!0)}h(a,t)};q(y,a=>{x(f).status!=200?a(i):a(c,!1)})}h(g,d)}),m(o),h(e,o),F()}var Qe=k('<div class="preview svelte-1hfbc1n"><div class="header svelte-1hfbc1n"><div class="title svelte-1hfbc1n"><a> </a></div> <button class="close svelte-1hfbc1n"><!></button></div> <div class="props"> </div> <!></div>');function Ze(e,s){j(s,!1);let o=Y(s,"tree",8),w=Y(s,"onClose",8);xe();var g=Z(),f=T(g);{var d=y=>{var i=Qe(),c=b(i),a=b(c),t=b(a);D(()=>O(t,"href",U.treeDetails(o().id)));var u=b(t,!0);D(()=>$(u,Me(o().species))),m(t),m(a);var v=I(a,2),p=b(v);De(p,{}),m(v),m(c);var r=I(c,2),l=b(r,!0);D(()=>$(l,Te(o()))),m(r);var n=I(r,2);Le(n,{get tree(){return o()}}),m(i),Ce("click",v,function(..._){var C;(C=w())==null||C.apply(this,_)}),h(y,i)};q(f,y=>{o()&&y(d)})}h(e,g),F()}const N=Ne(re.read("mapState")||{center:Pe,zoom:15});N.subscribe(e=>{re.write("mapState",e)});const qe=te(N,e=>e.center),Oe=te(N,e=>e.zoom);var Ue=k('<!> <div class="mapContainer svelte-11p9u5n"><!> <!></div>',1);function ca(e,s){j(s,!0);const o=ge(),w=()=>ee(qe,"$mapCenter",o),g=()=>ee(Oe,"$mapZoom",o),f=s.data.searchQuery;let d=_e(void 0);const y=f?`Map: ${f}`:"Map",i=l=>{V(d,be(l))},c=()=>{V(d,void 0)},a=(l,n)=>{N.set({center:l,zoom:n})};var t=Ue();he(l=>{pe.title="Tree Map"});var u=T(t);ye(u,{title:y});var v=I(u,2),p=b(v);we(p,{get center(){return w()},get zoom(){return g()},onChange:i,onMove:a,searchQuery:f,canAdd:!0});var r=I(p,2);Ze(r,{get tree(){return x(d)},onClose:c}),m(v),h(e,t),F()}export{ca as component,fa as universal};
