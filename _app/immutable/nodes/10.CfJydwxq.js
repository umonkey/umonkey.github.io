import{g as q}from"../chunks/entry.CTIW_epq.js";import{a as k,b as x,w as z}from"../chunks/api.BmLlYLDC.js";import{e as j}from"../chunks/index.C5KDXQmW.js";import"../chunks/disclose-version.DlFLgp1r.js";import{j as A,f as p,k as B,s as i,e as T,a4 as u,ab as L,g as I,aF as N,aq as M,t as P,aE as U}from"../chunks/index.6fWcJMZL.js";import{h as Y}from"../chunks/svelte-head.BfVEVBH-.js";import{c as $,a as l,t as y}from"../chunks/template.Cy3dU-Fh.js";import{s as G,i as F,a as J}from"../chunks/store.C3yr5Ypf.js";import{e as K,i as Q}from"../chunks/each.DbABizDz.js";import{r as R}from"../chunks/routes.BUE4i6ab.js";import"../chunks/legacy.D-anx2rK.js";import{t as S}from"../chunks/SvelteToast.svelte_svelte_type_style_lang.kVwYKxLT.js";import{f as D}from"../chunks/trees.XKNW-Keq.js";import{H as V}from"../chunks/Header.qZYYi1xn.js";import{T as X,a as Z,M as ee}from"../chunks/Menu.gzbzxZyK.js";import{p as te,a as ae}from"../chunks/props.CXIUh43G.js";import{i as re}from"../chunks/auth.0VXXE1bM.js";import{S as oe}from"../chunks/SignIn._3oTOS9Z.js";import{T as se,B as ne}from"../chunks/TextInput.Bkw2ewOM.js";import{C as ie}from"../chunks/Comment.ZNu_EoIZ.js";(function(){try{var t=typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},e=new t.Error().stack;e&&(t._sentryDebugIds=t._sentryDebugIds||{},t._sentryDebugIds[e]="26f2433a-2006-420e-a00e-1cf04347e2c9",t._sentryDebugIdIdentifier="sentry-dbid-26f2433a-2006-420e-a00e-1cf04347e2c9")}catch{}})();const me=async t=>{const e=await k.getTree(t);return e.status!==200&&j(404),x(e.data.users),e.data},de=async t=>{const e=await k.getTreeComments(t);return e.status!==200&&j(404),x(e.data.users),e.data.comments},E=async({params:t})=>{const e=t.id;return{id:e,tree:await me(e),comments:await de(e)}},ce=E?z(E):void 0,Oe=Object.freeze(Object.defineProperty({__proto__:null,load:ce},Symbol.toStringTag,{value:"Module"}));function ue(t,e){let a=te(e,"value",12,"");se(t,{label:"Comment",multiline:!0,hint:"Some hints or suggested edits.",get value(){return a()},set value(d){a(d)},$$legacy:!0})}var le=y('<p>Would you like to add a comment?</p> <div class="form"><!> <div class="buttons"><!></div></div>',1),fe=y("<p>You need to be authenticated to add comments.</p> <!>",1);function pe(t,e){A(e,!0);const a=G(),d=()=>J(re,"$isAuthenticated",a);let c=N("");const v=()=>{e.onSubmit(u(c))};var f=$(),g=p(f);{var w=s=>{var n=le(),m=i(p(n),2),b=T(m);ue(b,{get value(){return u(c)},set value(r){L(c,ae(r))}});var h=i(b,2),C=T(h),o=M(()=>!u(c));ne(C,{onClick:v,label:"Submit comment",get disabled(){return u(o)}}),I(h),I(m),l(s,n)},_=s=>{var n=fe(),m=i(p(n),2);oe(m,{}),l(s,n)};F(g,s=>{d()?s(w):s(_,!1)})}l(t,f),B()}var ve=y("<p>No comments for this tree yet.</p>"),ge=y('<!> <!> <!> <!> <div class="container svelte-11j1l8y"><!> <!></div>',1);function We(t,e){A(e,!0);const a=e.data.tree,d=e.data.comments,c=o=>{k.addComment(a.id,o).then(r=>{r.status>=200&&r.status<300?(S.push("Comment added."),q(R.treeDetails(a.id))):(console.info(`Error ${r.status} adding a comment.`),S.push("Error adding comment."))}).catch(r=>{console.error("Exception while adding a comment.",r),S.push("Error adding comment.")})};var v=ge();Y(o=>{P(()=>U.title=`${D(a.species)??""} - Details`)});var f=p(v);V(f,{title:"Tree"});var g=i(f,2),w=M(()=>D(a.species));X(g,{get title(){return u(w)},get address(){return a.address}});var _=i(g,2);Z(_,{get tree(){return a.id},active:"comments"});var s=i(_,2);ee(s,{get id(){return a.id}});var n=i(s,2),m=T(n);{var b=o=>{var r=$(),H=p(r);K(H,17,()=>d,Q,(O,W)=>{ie(O,{get comment(){return u(W)}})}),l(o,r)},h=o=>{var r=ve();l(o,r)};F(m,o=>{d.length>0?o(b):o(h,!1)})}var C=i(m,2);pe(C,{onSubmit:c}),I(n),l(t,v),B()}export{We as component,Oe as universal};
