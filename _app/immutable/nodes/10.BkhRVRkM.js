import{g as N}from"../chunks/entry.OImHg3gI.js";import{w as P}from"../chunks/load.BtWDkKTt.js";import{e as M}from"../chunks/index.B6VvGhVk.js";import{a as k,b as j,g as W}from"../chunks/api.DTgSd7Mi.js";import"../chunks/disclose-version.vMxi1LYk.js";import{T as x,N as y,U as D,O as i,P as _,a6 as h,ah as z,R as b,aM as F,a8 as K,ad as L,t as q,aK as R}from"../chunks/index.D2QBpCmX.js";import{h as Y}from"../chunks/svelte-head.CYodAuYg.js";import{c as A,a as v,t as w}from"../chunks/template.AFpqK3Ql.js";import{i as B}from"../chunks/if.DIZMYV78.js";import{e as G,i as J}from"../chunks/each.DJDUisb8.js";import{r as Q}from"../chunks/routes.M12FsiPu.js";import"../chunks/legacy.B__8PB0f.js";import{t as S}from"../chunks/SvelteToast.svelte_svelte_type_style_lang.DwTnN7fN.js";import{H as V}from"../chunks/Header.CvSZHzu2.js";import{T as X,a as Z,M as ee}from"../chunks/Menu.Cfg4atg4.js";import{p as O,a as te}from"../chunks/props.Cz6Hg2a0.js";import{s as ae,a as oe,b as E}from"../chunks/store.DvNMo4ai.js";import{i as re}from"../chunks/auth.CRT65m0h.js";import{S as se}from"../chunks/SignIn.Dpcar9A6.js";import{T as ne,B as ie}from"../chunks/Button.15ih1UMP.js";import{i as me}from"../chunks/lifecycle.y8OLtr5S.js";import{f as de}from"../chunks/strings.BgwivUaA.js";(function(){try{var t=typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},e=new t.Error().stack;e&&(t._sentryDebugIds=t._sentryDebugIds||{},t._sentryDebugIds[e]="80acaec4-c1c1-4477-b011-f138b498b483",t._sentryDebugIdIdentifier="sentry-dbid-80acaec4-c1c1-4477-b011-f138b498b483")}catch{}})();const ce=async t=>{const e=await k.getTree(t);return e.status!==200&&M(404),j(e.data.users),e.data},le=async t=>{const e=await k.getTreeComments(t);return e.status!==200&&M(404),j(e.data.users),e.data.comments},$=async({params:t})=>{const e=t.id;return{id:e,tree:await ce(e),comments:await le(e)}},ue=$?P($):void 0,Fe=Object.freeze(Object.defineProperty({__proto__:null,load:ue},Symbol.toStringTag,{value:"Module"}));function ve(t,e){let a=O(e,"value",12,"");ne(t,{label:"Comment",multiline:!0,hint:"Some hints or suggested edits.",get value(){return a()},set value(m){a(m)},$$legacy:!0})}var fe=w('<p>Would you like to add a comment?</p> <div class="form"><!> <div class="buttons"><!></div></div>',1),pe=w("<p>You need to be authenticated to add comments.</p> <!>",1);function ge(t,e){x(e,!0);const a=ae(),m=()=>oe(re,"$isAuthenticated",a);let d=F("");const c=()=>{e.onSubmit(h(d))};var s=A(),f=y(s);{var u=n=>{var l=fe(),g=i(y(l),2),C=_(g);ve(C,{get value(){return h(d)},set value(I){z(d,te(I))}});var T=i(C,2),r=_(T),o=K(()=>!h(d));ie(r,{onClick:c,label:"Submit comment",get disabled(){return h(o)}}),b(T),b(g),v(n,l)},p=n=>{var l=pe(),g=i(y(l),2);se(g,{}),v(n,l)};B(f,n=>{m()?n(u):n(p,!1)})}v(t,s),D()}var _e=w('<div class="comment svelte-4a5rpe"><blockquote class="svelte-4a5rpe"> </blockquote> <div class="meta svelte-4a5rpe"> </div></div>');function be(t,e){x(e,!1);let a=O(e,"comment",8);const m=L(W)(a().added_by),d=de(a().added_at);me();var c=_e(),s=_(c),f=_(s,!0);b(s);var u=i(s,2),p=_(u);b(u),b(c),q(()=>{E(f,a().message),E(p,`${d??""} Â· ${m.name??""}`)}),v(t,c),D()}var he=w("<p>No comments for this tree yet.</p>"),ye=w('<!> <!> <!> <!> <div class="container svelte-11j1l8y"><!> <!></div>',1);function Ke(t,e){x(e,!0);const a=e.data.tree,m=e.data.comments,d=r=>{k.addComment(a.id,r).then(o=>{o.status>=200&&o.status<300?(S.push("Comment added."),N(Q.treeDetails(a.id))):(console.info(`Error ${o.status} adding a comment.`),S.push("Error adding comment."))}).catch(o=>{console.error("Exception while adding a comment.",o),S.push("Error adding comment.")})};var c=ye();Y(r=>{q(()=>R.title=`${a.species??""} - Details`)});var s=y(c);V(s,{title:"Tree"});var f=i(s,2);X(f,{get title(){return a.species}});var u=i(f,2);Z(u,{get tree(){return a.id},active:"comments"});var p=i(u,2);ee(p,{get id(){return a.id}});var n=i(p,2),l=_(n);{var g=r=>{var o=A(),I=y(o);G(I,17,()=>m,J,(U,H)=>{be(U,{get comment(){return h(H)}})}),v(r,o)},C=r=>{var o=he();v(r,o)};B(l,r=>{m.length>0?r(g):r(C,!1)})}var T=i(l,2);ge(T,{onSubmit:d}),b(n),v(t,c),D()}export{Ke as component,Fe as universal};
