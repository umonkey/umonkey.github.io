{"version":3,"file":"8.BVwuqpmd.js","sources":["../../../../../../src/routes/tree/[id=treeid]/comments/+page.ts?sentry-auto-wrap","../../../../../../src/routes/tree/[id=treeid]/comments/+page.ts","../../../../../../src/lib/components/forms/CommentInput.svelte","../../../../../../src/lib/components/forms/CommentForm.svelte","../../../../../../src/routes/tree/[id=treeid]/comments/+page.svelte"],"sourcesContent":["import type { Load } from '@sveltejs/kit';\nimport type { ITree } from '$lib/types';\nimport { error } from '@sveltejs/kit';\nimport { apiClient } from '$lib/api';\n\nexport const load: Load = async ({ params }): Promise<{\n\tid: string;\n\ttree: ITree;\n}> => {\n\tconst treeId = params.id;\n\n\tif (!treeId) {\n\t\terror(404);\n\t}\n\n\tconst res = await apiClient.getTree(treeId);\n\n\tif (res.status !== 200) {\n\t\terror(404);\n\t}\n\n\treturn {\n\t\tid: treeId,\n\t\ttree: res.data\n\t};\n};\n","import { wrapLoadWithSentry } from \"@sentry/sveltekit\";import * as userModule from \"/home/hex/src/treemap/frontend-v2/src/routes/tree/[id=treeid]/comments/+page.ts?sentry-auto-wrap\";export const load = userModule.load ? wrapLoadWithSentry(userModule.load) : undefined;export * from \"/home/hex/src/treemap/frontend-v2/src/routes/tree/[id=treeid]/comments/+page.ts?sentry-auto-wrap\";","<script>\n\timport TextInput from '$lib/components/forms/TextInput.svelte';\n\texport let value = '';\n</script>\n\n<TextInput label=\"Comment\" bind:value multiline={true} hint=\"Some hints or suggested edits.\" />\n","<script>\n\timport { isAuthenticated } from '$lib/stores/auth';\n\n\timport SignIn from '$lib/components/auth/SignIn.svelte';\n\timport CommentInput from '$lib/components/forms/CommentInput.svelte';\n\timport Button from '$lib/components/forms/Button.svelte';\n\n\tconst { onSubmit } = $props();\n\n\tlet message = $state('');\n\n\tconst onButtonClicked = () => {\n\t\tonSubmit(message);\n\t};\n</script>\n\n{#if $isAuthenticated}\n\t<p>Would you like to add a comment?</p>\n\t<CommentInput bind:value={message} />\n\t<div class=\"buttons\">\n\t\t<Button onClick={onButtonClicked} label=\"Submit comment\" disabled={!message} />\n\t</div>\n{:else}\n\t<p>You need to be authenticated to add comments.</p>\n\t<SignIn />\n{/if}\n\n<style>\n\t.buttons {\n\t\tmargin-top: var(--gap);\n\t}\n</style>\n","<script lang=\"ts\">\n\timport { apiClient } from '$lib/api';\n\timport { goto } from '$app/navigation';\n\timport { routes } from '$lib/routes';\n\timport { toast } from '@zerodevx/svelte-toast';\n\n\timport Header from '$lib/components/tree/Header.svelte';\n\timport Tabs from '$lib/components/tree/Tabs.svelte';\n\timport Title from '$lib/components/tree/Title.svelte';\n\timport TreeMenu from '$lib/components/tree/Menu.svelte';\n\timport CommentForm from '$lib/components/forms/CommentForm.svelte';\n\n\tconst { data } = $props();\n\tconst tree = data.tree;\n\n\tconst onSubmit = (message: string) => {\n\t\tapiClient\n\t\t\t.addComment(tree.id, message)\n\t\t\t.then((res) => {\n\t\t\t\tif (res.status >= 200 && res.status < 300) {\n\t\t\t\t\ttoast.push('Comment added.');\n\t\t\t\t\tgoto(routes.treeDetails(tree.id));\n\t\t\t\t} else {\n\t\t\t\t\tconsole.info(`Error ${res.status} adding a comment.`);\n\t\t\t\t\ttoast.push('Error adding comment.');\n\t\t\t\t}\n\t\t\t})\n\t\t\t.catch((e) => {\n\t\t\t\tconsole.error('Exception while adding a comment.', e);\n\t\t\t\ttoast.push('Error adding comment.');\n\t\t\t});\n\t};\n</script>\n\n<svelte:head>\n\t<title>{tree.species} - Details</title>\n</svelte:head>\n\n<Header title=\"Tree\" />\n<Title title={tree.species} />\n<Tabs tree={tree.id} active=\"comments\" />\n<TreeMenu id={tree.id} />\n\n<div class=\"container\">\n\t<p>No comments for this tree yet.</p>\n\t<CommentForm {onSubmit} />\n</div>\n\n<style>\n\t.container {\n\t\tpadding: 0 var(--gap);\n\t}\n</style>\n"],"names":["load","params","treeId","error","res","apiClient","userModule.load","wrapLoadWithSentry","value","message","onButtonClicked","$.proxy","$$value","$isAuthenticated","$$render","consequent","alternate","tree","onSubmit","toast","goto","routes","e","$.template_effect","$.document"],"mappings":"g0CAKO,MAAMA,EAAa,MAAO,CAAE,OAAAC,KAG7B,CACL,MAAMC,EAASD,EAAO,GAEjBC,GACJC,EAAM,GAAG,EAGV,MAAMC,EAAM,MAAMC,EAAU,QAAQH,CAAM,EAEtC,OAAAE,EAAI,SAAW,KAClBD,EAAM,GAAG,EAGH,CACN,GAAID,EACJ,KAAME,EAAI,IACX,CACD,ECzBmMJ,EAAOM,EAAkBC,EAAmBD,CAAe,EAAI,6HCEtP,IAAAE,iBAAQ,EAAE,iCAG2B,kVCI5C,IAAAC,IAAiB,EAAE,QAEjBC,EAAe,IAAA,cACXD,CAAO,CAAA,iFAMSA,CAAO,kBAAPA,EAAOE,EAAAC,CAAA,CAAA,oCAEoCH,CAAO,CAAA,eAA1DC,sHAJdG,EAAgB,EAAAC,EAAAC,CAAA,EAAAD,EAAAE,EAAA,EAAA,4JCHd,MAAAC,SAAY,KAEZC,EAAYT,GAAe,CAChCJ,EACE,WAAWY,EAAK,GAAIR,CAAO,EAC3B,KAAML,GAAG,CACLA,EAAI,QAAU,KAAOA,EAAI,OAAS,KACrCe,EAAM,KAAK,gBAAgB,EAC3BC,EAAKC,EAAO,YAAYJ,EAAK,EAAE,CAAA,IAE/B,QAAQ,KAAc,SAAAb,EAAI,MAAM,oBAAA,EAChCe,EAAM,KAAK,uBAAuB,EAGnC,CAAA,EAAA,MAAOG,GAAC,CACR,QAAQ,MAAM,oCAAqCA,CAAC,EACpDH,EAAM,KAAK,uBAAuB,sBAM7BI,EAAA,IAAAC,EAAA,MAAA,GAAAP,EAAK,SAAO,EAAA,YAAA,iEAIP,OAAAA,EAAK,wCACP,OAAAA,EAAK,mDACH,OAAAA,EAAK"}