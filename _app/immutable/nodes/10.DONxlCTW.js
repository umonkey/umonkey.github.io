import{g as H}from"../chunks/entry.BRSuLOjh.js";import{a as k,b as E,w as O}from"../chunks/api.3STlV-ud.js";import{e as x}from"../chunks/index.CufNn3zm.js";import"../chunks/disclose-version.CKFfokN4.js";import{j,f as p,k as A,s as i,e as I,a4 as f,ab as W,g as S,aF as q,aq as z,t as L,aE as N}from"../chunks/index.6fWcJMZL.js";import{h as P}from"../chunks/svelte-head.BsK74sys.js";import{c as B,a as u,t as w}from"../chunks/template.B1mf6kze.js";import{s as U,i as M,a as Y}from"../chunks/store.XKo8_Y2K.js";import{e as G,i as J}from"../chunks/each.Cwc-_f-6.js";import{r as K}from"../chunks/routes.B1Jkliqe.js";import"../chunks/legacy.C5Ep07oP.js";import{t as T}from"../chunks/SvelteToast.svelte_svelte_type_style_lang.DZL4l-7g.js";import{H as Q}from"../chunks/Header.CqSyHY-W.js";import{T as R,a as V,M as X}from"../chunks/Menu.pIHm3L38.js";import{p as Z,a as ee}from"../chunks/props.Drv8p2JQ.js";import{i as te}from"../chunks/auth.DK59P2ne.js";import{S as ae}from"../chunks/SignIn.C5F51i_2.js";import{T as oe,B as re}from"../chunks/TextInput.BiqbpmT0.js";import{C as se}from"../chunks/Comment.BPOu7ioW.js";(function(){try{var t=typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},e=new t.Error().stack;e&&(t._sentryDebugIds=t._sentryDebugIds||{},t._sentryDebugIds[e]="90d25e2f-e166-4154-828e-ce4af9978552",t._sentryDebugIdIdentifier="sentry-dbid-90d25e2f-e166-4154-828e-ce4af9978552")}catch{}})();const ne=async t=>{const e=await k.getTree(t);return e.status!==200&&x(404),E(e.data.users),e.data},ie=async t=>{const e=await k.getTreeComments(t);return e.status!==200&&x(404),E(e.data.users),e.data.comments},D=async({params:t})=>{const e=t.id;return{id:e,tree:await ne(e),comments:await ie(e)}},me=D?O(D):void 0,$e=Object.freeze(Object.defineProperty({__proto__:null,load:me},Symbol.toStringTag,{value:"Module"}));function de(t,e){let a=Z(e,"value",12,"");oe(t,{label:"Comment",multiline:!0,hint:"Some hints or suggested edits.",get value(){return a()},set value(m){a(m)},$$legacy:!0})}var ce=w('<p>Would you like to add a comment?</p> <div class="form"><!> <div class="buttons"><!></div></div>',1),ue=w("<p>You need to be authenticated to add comments.</p> <!>",1);function le(t,e){j(e,!0);const a=U(),m=()=>Y(te,"$isAuthenticated",a);let d=q("");const v=()=>{e.onSubmit(f(d))};var l=B(),g=p(l);{var _=s=>{var n=ce(),c=i(p(n),2),h=I(c);de(h,{get value(){return f(d)},set value(C){W(d,ee(C))}});var y=i(h,2),r=I(y),o=z(()=>!f(d));re(r,{onClick:v,label:"Submit comment",get disabled(){return f(o)}}),S(y),S(c),u(s,n)},b=s=>{var n=ue(),c=i(p(n),2);ae(c,{}),u(s,n)};M(g,s=>{m()?s(_):s(b,!1)})}u(t,l),A()}var fe=w("<p>No comments for this tree yet.</p>"),pe=w('<!> <!> <!> <!> <div class="container svelte-11j1l8y"><!> <!></div>',1);function Fe(t,e){j(e,!0);const a=e.data.tree,m=e.data.comments,d=r=>{k.addComment(a.id,r).then(o=>{o.status>=200&&o.status<300?(T.push("Comment added."),H(K.treeDetails(a.id))):(console.info(`Error ${o.status} adding a comment.`),T.push("Error adding comment."))}).catch(o=>{console.error("Exception while adding a comment.",o),T.push("Error adding comment.")})};var v=pe();P(r=>{L(()=>N.title=`${a.species??""} - Details`)});var l=p(v);Q(l,{title:"Tree"});var g=i(l,2);R(g,{get title(){return a.species}});var _=i(g,2);V(_,{get tree(){return a.id},active:"comments"});var b=i(_,2);X(b,{get id(){return a.id}});var s=i(b,2),n=I(s);{var c=r=>{var o=B(),C=p(o);G(C,17,()=>m,J,($,F)=>{se($,{get comment(){return f(F)}})}),u(r,o)},h=r=>{var o=fe();u(r,o)};M(n,r=>{m.length>0?r(c):r(h,!1)})}var y=i(n,2);le(y,{onSubmit:d}),S(s),u(t,v),A()}export{Fe as component,$e as universal};
