{"version":3,"file":"8.B94GBlUs.js","sources":["../../../../../../src/routes/tree/[id=treeid]/+page.ts?sentry-auto-wrap","../../../../../../src/routes/tree/[id=treeid]/+page.ts","../../../../../../src/lib/components/tree/ShareButton.svelte","../../../../../../src/lib/components/tree/Actions.svelte","../../../../../../src/lib/components/tree/Gallery.svelte","../../../../../../src/lib/components/tree/Links.svelte","../../../../../../src/lib/components/tree/Properties.svelte","../../../../../../src/routes/tree/[id=treeid]/+page.svelte"],"sourcesContent":["import type { Load } from '@sveltejs/kit';\nimport type { ITree } from '$lib/types';\nimport { error } from '@sveltejs/kit';\nimport { apiClient } from '$lib/api';\n\nexport const load: Load = async ({\n\tparams\n}): Promise<{\n\tid: string;\n\ttree: ITree;\n}> => {\n\tconst treeId = params.id;\n\n\tif (!treeId) {\n\t\terror(404);\n\t}\n\n\tconst res = await apiClient.getTree(treeId);\n\n\tif (res.status !== 200) {\n\t\terror(404);\n\t}\n\n\treturn {\n\t\tid: treeId,\n\t\ttree: res.data\n\t};\n};\n","import { wrapLoadWithSentry } from \"@sentry/sveltekit\";import * as userModule from \"/home/hex/src/umonkey/treemap/frontend-v2/src/routes/tree/[id=treeid]/+page.ts?sentry-auto-wrap\";export const load = userModule.load ? wrapLoadWithSentry(userModule.load) : undefined;export * from \"/home/hex/src/umonkey/treemap/frontend-v2/src/routes/tree/[id=treeid]/+page.ts?sentry-auto-wrap\";","<script lang=\"ts\">\n\timport { toast } from '@zerodevx/svelte-toast';\n\timport ShareIcon from '$lib/icons/ShareIcon.svelte';\n\n\tconst onClick = async () => {\n\t\tif (!navigator.share) {\n\t\t\ttoast.push(\"Your browser doesn't support sharing.\");\n\t\t\treturn;\n\t\t}\n\n\t\ttry {\n\t\t\tawait navigator.share({\n\t\t\t\ttitle: document.title,\n\t\t\t\turl: window.location.href\n\t\t\t});\n\t\t} catch (e) {\n\t\t\tconsole.error('Error sharing a tree.', e);\n\t\t\ttoast.push('Error sharing this page.');\n\t\t}\n\t};\n</script>\n\n<button type=\"button\" onclick={onClick} title=\"Share this page\">\n\t<ShareIcon />\n</button>\n\n<style>\n\tbutton {\n\t\tbackground: none;\n\t\tborder: none;\n\t\tcolor: inherit;\n\t\tpadding: 0;\n\t\tmargin: 0;\n\t\tcursor: pointer;\n\t}\n</style>\n","<script lang=\"ts\">\n\timport { routes } from '$lib/routes';\n\timport { FEATURES } from '$lib/features';\n\n\timport ChatIcon from '$lib/icons/ChatIcon.svelte';\n\timport HeartIcon from '$lib/icons/HeartIcon.svelte';\n\timport SaveIcon from '$lib/icons/SaveIcon.svelte';\n\timport ShareButton from '$lib/components/tree/ShareButton.svelte';\n\n\tconst { tree } = $props();\n</script>\n\n<div class=\"actions\">\n\t{#if FEATURES.likes}\n\t\t<div><HeartIcon /></div>\n\t{/if}\n\t<div><a href={routes.treeComments(tree)}><ChatIcon /></a></div>\n\t<div><ShareButton /></div>\n\t{#if FEATURES.bookmarks}\n\t\t<div class=\"sep\"></div>\n\t\t<div><SaveIcon /></div>\n\t{/if}\n</div>\n\n<style>\n\t.actions {\n\t\tdisplay: flex;\n\t\tgap: calc(var(--gap) * 1.5);\n\t\tjustify-content: left;\n\t\tmargin: var(--gap) 0;\n\t\tpadding: 0 var(--gap);\n\n\t\t& > div {\n\t\t\twidth: 20px;\n\t\t\theight: 20px;\n\t\t\tcolor: var(--icon-color-secondary);\n\t\t\ttext-align: center;\n\t\t}\n\n\t\t.sep {\n\t\t\tflex-grow: 1;\n\t\t}\n\n\t\ta {\n\t\t\tcolor: inherit;\n\t\t}\n\t}\n</style>\n","<script lang=\"ts\">\n\timport { routes } from '$lib/routes';\n\timport type { ITreeFile } from '$lib/types';\n\timport { formatDate } from '$lib/utils/strings';\n\timport { getUser } from '$lib/stores/userStore';\n\timport { get } from 'svelte/store';\n\n\texport let files: ITreeFile[] = [];\n\n\tconst added_at = (file: ITreeFile) => {\n\t\tif (!file.added_at || !file.added_by) {\n\t\t\treturn '';\n\t\t}\n\n\t\tconst user = get(getUser)(file.added_by);\n\n\t\tif (user === undefined) {\n\t\t\treturn '';\n\t\t}\n\n\t\tconst date = formatDate(file.added_at);\n\t\treturn `${date} by ${user.name}`;\n\t};\n</script>\n\n<div class=\"gallery\">\n\t<div class=\"slides\">\n\t\t{#each files as file, idx}\n\t\t\t<div>\n\t\t\t\t<img src={routes.file(file.small_id)} alt=\"See how good is this tree.\" />\n\t\t\t\t<div class=\"imgno\">{idx + 1}/{files.length}</div>\n\t\t\t\t{#if file.added_at}\n\t\t\t\t\t<div class=\"date\">{added_at(file)}</div>\n\t\t\t\t{/if}\n\t\t\t</div>\n\t\t{:else}\n\t\t\t<div>\n\t\t\t\t<img src=\"/tree.jpg\" alt=\"no photos of this tree\" />\n\t\t\t</div>\n\t\t{/each}\n\t</div>\n</div>\n\n<style>\n\t.gallery {\n\t\tposition: relative;\n\t\tbox-sizing: border-box;\n\t}\n\n\t.imgno {\n\t\tposition: absolute;\n\t\tright: var(--gap);\n\t\ttop: var(--gap);\n\t\tbackground-color: rgba(0, 0, 0, 0.85);\n\t\tcolor: #fff;\n\t\tborder-radius: 9px;\n\t\tfont-size: 14px;\n\t\tpadding: 2px 8px;\n\t\tz-index: 2;\n\t}\n\n\t.slides {\n\t\tdisplay: flex;\n\t\tmax-width: 100%;\n\t\taspect-ratio: 1/1;\n\n\t\toverflow-x: auto;\n\t\toverflow-y: hidden;\n\t\twhite-space: nowrap;\n\n\t\tscroll-snap-type: x mandatory;\n\t\tscrollbar-width: none;\n\n\t\t& > div {\n\t\t\tdisplay: block;\n\t\t\tposition: relative;\n\t\t\tscroll-snap-align: center;\n\t\t\tscroll-snap-stop: always;\n\n\t\t\tmin-height: 100%;\n\t\t\tmin-width: 100%;\n\n\t\t\taspect-ratio: 1/1;\n\t\t\ttext-align: center;\n\t\t\talign-content: center;\n\t\t\tscroll-snap-align: center;\n\n\t\t\timg {\n\t\t\t\tborder: none;\n\t\t\t\tobject-position: center;\n\t\t\t\tobject-fit: cover;\n\t\t\t\theight: 100%;\n\t\t\t\twidth: 100%;\n\t\t\t\tz-index: 1;\n\t\t\t}\n\t\t}\n\n\t\t.date {\n\t\t\tposition: absolute;\n\t\t\tbottom: var(--gap);\n\t\t\tleft: var(--gap);\n\t\t\tbackground-color: rgba(0, 0, 0, 0.75);\n\t\t\tcolor: #fff;\n\t\t\tfont-size: 14px;\n\t\t\tpadding: 2px 4px;\n\n\t\t\t/* Prevent text overflow in case of really long username */\n\t\t\tmax-width: calc(100% - 2 * var(--gap) - 8px);\n\t\t\toverflow: hidden;\n\t\t\ttext-overflow: ellipsis;\n\t\t}\n\t}\n</style>\n","<script>\n\timport { formatLinks } from '$lib/utils/trees';\n\n\tconst { tree } = $props();\n\tconst links = formatLinks(tree);\n</script>\n\n{#if links.length > 0}\n\t<ul class=\"links\">\n\t\t{#each links as link}\n\t\t\t<li><a href={link.url} target=\"_blank\">{link.text}</a></li>\n\t\t{/each}\n\t</ul>\n{/if}\n\n<style>\n\t.links {\n\t\tdisplay: flex;\n\t\tgap: var(--gap);\n\t\tlist-style: none;\n\t\tpadding: 0 var(--gap);\n\t}\n</style>\n","<script>\n\timport { formatMeters, formatCentimeters } from '$lib/utils/trees';\n\n\tconst { tree } = $props();\n</script>\n\n<div class=\"properties\">\n\t<dl>\n\t\t<dt>Height</dt>\n\t\t<dd>{formatMeters(tree.height)}</dd>\n\t</dl>\n\t<dl>\n\t\t<dt>Canopy</dt>\n\t\t<dd>{formatMeters(tree.diameter)}</dd>\n\t</dl>\n\t<dl>\n\t\t<dt>Trunk</dt>\n\t\t<dd>{formatCentimeters(tree.circumference)}</dd>\n\t</dl>\n\t<dl>\n\t\t<dt>State</dt>\n\t\t<dd>{tree.state}</dd>\n\t</dl>\n\t<dl>\n\t\t<dt>Year</dt>\n\t\t<dd>???</dd>\n\t</dl>\n</div>\n\n<style>\n\t.properties {\n\t\tcolumns: 2;\n\t\tgap: 0;\n\t\tmargin: var(--gap) 0;\n\n\t\tborder-top: 1px solid var(--sep-color);\n\t\tpadding-top: var(--gap);\n\t\tbox-sizing: border-box;\n\t}\n\n\tdl {\n\t\tdisplay: flex;\n\t\tflex-direction: row;\n\t\tmargin: 0 0 5px;\n\t\tpadding: 0 var(--gap);\n\t}\n\n\tdt {\n\t\tflex-shrink: 1;\n\t\tflex-grow: 0;\n\t}\n\n\tdd {\n\t\tflex-basis: 50%;\n\t\tflex-shrink: 1;\n\t\tflex-grow: 1;\n\t\ttext-align: right;\n\t\tmargin: 0;\n\t}\n\n\tdd {\n\t\twhite-space: nowrap;\n\t}\n</style>\n","<script lang=\"ts\">\n\timport Actions from '$lib/components/tree/Actions.svelte';\n\timport Description from '$lib/components/tree/Description.svelte';\n\timport Gallery from '$lib/components/tree/Gallery.svelte';\n\timport Header from '$lib/components/tree/Header.svelte';\n\timport Links from '$lib/components/tree/Links.svelte';\n\timport Properties from '$lib/components/tree/Properties.svelte';\n\timport Tabs from '$lib/components/tree/Tabs.svelte';\n\timport Title from '$lib/components/tree/Title.svelte';\n\timport TreeMenu from '$lib/components/tree/Menu.svelte';\n\n\tconst { data } = $props();\n\tconst tree = data.tree;\n</script>\n\n<svelte:head>\n\t<title>{tree.species} - Details</title>\n</svelte:head>\n\n<Header title=\"Tree\" />\n<Title title={tree.species} />\n<Tabs tree={tree.id} active=\"details\" />\n<Gallery files={tree.files} />\n<Actions tree={tree.id} />\n<Properties {tree} />\n<Links {tree} />\n<Description text={tree.notes} />\n<TreeMenu id={tree.id} />\n"],"names":["load","params","treeId","error","res","apiClient","userModule.load","wrapLoadWithSentry","onClick","toast","e","$.template_effect","$.set_attribute","a","routes","$$props","files","$.prop","added_at","file","user","get","getUser","formatDate","idx","img","$.get","$.set_text","text_1","$$render","consequent","text","links","formatLinks","$.each","ul","link","formatMeters","text_2","formatCentimeters","tree","$.document"],"mappings":"o4CAKO,MAAMA,EAAa,MAAO,CAChC,OAAAC,CACD,IAGM,CACL,MAAMC,EAASD,EAAO,GAEjBC,GACJC,EAAM,GAAG,EAGV,MAAMC,EAAM,MAAMC,EAAU,QAAQH,CAAM,EAEtC,OAAAE,EAAI,SAAW,KAClBD,EAAM,GAAG,EAGH,CACN,GAAID,EACJ,KAAME,EAAI,IACX,CACD,EC3BkMJ,GAAOM,EAAkBC,EAAmBD,CAAe,EAAI,k7CCI1PE,GAAO,SAAA,CACP,GAAA,CAAA,UAAU,MAAK,CACnBC,EAAM,KAAK,uCAAuC,aAK5C,MAAA,UAAU,MAAK,CACpB,MAAO,SAAS,MAChB,IAAK,OAAO,SAAS,aAEdC,EAAC,CACT,QAAQ,MAAM,wBAAyBA,CAAC,EACxCD,EAAM,KAAK,0BAA0B,oJAKTD,EAAO,kSCNvBG,EAAA,IAAAC,EAAAC,EAAA,OAAAC,EAAO,aAAYC,EAAA,IAAA,CAAA,CAAA;8qBCTtBC,EAAkBC,EAAAF,EAAA,QAAA,GAAA,IAAA,EAAA,EAEvB,MAAAG,EAAYC,GAAe,CAC3B,GAAA,CAAAA,EAAK,UAAa,CAAAA,EAAK,eACpB,GAGF,MAAAC,EAAOC,EAAIC,CAAO,EAAEH,EAAK,QAAQ,EAEnC,OAAAC,IAAS,OACL,MAGKG,EAAWJ,EAAK,QAAQ,CACvB,OAAOC,EAAK,IAAI,gCAMvBJ,OAASG,EAAIK,IAAA,mBAERb,EAAA,IAAAC,EAAAa,EAAA,MAAAX,EAAO,KAAKY,EAAAP,CAAI,EAAC,QAAQ,CAAA,CAAA,wEAGfR,EAAA,IAAAgB,EAAAC,EAAAV,IAASC,CAAI,CAAA,CAAA,CAAA,uBAD5BO,EAAAP,CAAI,EAAC,UAAQU,EAAAC,CAAA,SADEnB,EAAA,IAAAgB,EAAAI,EAAA,GAAAP,EAAM,CAAI,IAAAR,IAAM,QAAM,EAAA,EAAA,CAAA,4KC1BvC,MAAAgB,EAAQC,EAAWlB,EAAA,IAAA,yCAKjBmB,EAAAC,EAAA,GAAA,IAAAH,OAASI,IAAI,8CACNxB,EAAAC,EAAA,OAAAa,EAAAU,CAAI,EAAC,GAAG,EAAmBT,EAAAI,EAAAL,EAAAU,CAAI,EAAC,IAAI,kCAH/CJ,EAAM,OAAS,GAACH,EAAAC,CAAA,opBCEdnB,EAAA,IAAAgB,EAAAI,EAAAM,SAAkB,MAAM,CAAA,CAAA,+CAIxB1B,EAAA,IAAAgB,EAAAC,EAAAS,SAAkB,QAAQ,CAAA,CAAA,+CAI1B1B,EAAA,IAAAgB,EAAAW,EAAAC,SAAuB,aAAa,CAAA,CAAA,oFAI/B,KAAK,CAAA,wFCTV,MAAAC,SAAY,sBAIV7B,EAAA,IAAA8B,EAAA,MAAA,GAAAD,EAAK,SAAO,EAAA,YAAA,kEAIP,OAAAA,EAAK,yCACP,OAAAA,EAAK,sDACD,OAAAA,EAAK,uCACN,OAAAA,EAAK,4FAGD,OAAAA,EAAK,qCACV,OAAAA,EAAK"}