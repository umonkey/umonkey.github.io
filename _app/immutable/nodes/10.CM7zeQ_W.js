import{g as re}from"../chunks/entry.DCaMQVoQ.js";import{a as q,w as le}from"../chunks/api.DDDsSy4Q.js";import{e as R}from"../chunks/index.CDUxX0v-.js";import"../chunks/disclose-version.CVLrmm-c.js";import{e as Y,R as Z,aM as g,O as n,P as h,ab as o,t as D,T as ee,a8 as p,Q as m,$ as oe,aQ as ne,a2 as G,N as J,aB as se}from"../chunks/index.CbWQdyPD.js";import{h as ie}from"../chunks/svelte-head.DlRxUE2U.js";import{a as x,t as $}from"../chunks/template.FARQGre2.js";import{i as ue,p as w,a as u}from"../chunks/props.BwWGETsP.js";import{r as ve}from"../chunks/routes.LLz7mK1U.js";import"../chunks/legacy.Cuu4uX5Q.js";import{t as K}from"../chunks/SvelteToast.svelte_svelte_type_style_lang.B0Rm7KC1.js";import{A as ce}from"../chunks/AuthWrapper.JhjI4wjx.js";import{i as de,b as U}from"../chunks/store.zYOmaikO.js";import{e as pe,i as fe}from"../chunks/each.8C-LENRi.js";import{r as me}from"../chunks/attributes.Bszi7fWb.js";import{t as _e}from"../chunks/class.Xtb3dM_A.js";import{l as ge,d as he}from"../chunks/events.Dh_5afs_.js";import{b as be}from"../chunks/input.D6BW4Hot.js";import{T as E,B as V}from"../chunks/Button.BHvtqtSM.js";import{H as ye}from"../chunks/Header.q0CrcpGa.js";(function(){try{var e=typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},t=new e.Error().stack;t&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[t]="4602defc-cc40-4b0a-bb23-f462ccf8fdac",e._sentryDebugIdIdentifier="sentry-dbid-4602defc-cc40-4b0a-bb23-f462ccf8fdac")}catch{}})();function te(e,t,a){if(e.multiple)return ke(e,t);for(var r of e.options){var l=C(r);if(ue(l,t)){r.selected=!0;return}}(!a||t!==void 0)&&(e.selectedIndex=-1)}function we(e,t){Y(()=>{var a=new MutationObserver(()=>{var r=e.__value;te(e,r)});return a.observe(e,{childList:!0,subtree:!0,attributes:!0,attributeFilter:["value"]}),()=>{a.disconnect()}})}function Se(e,t,a=t){var r=!0;ge(e,"change",l=>{var s=l?"[selected]":":checked",i;if(e.multiple)i=[].map.call(e.querySelectorAll(s),C);else{var v=e.querySelector(s)??e.querySelector("option:not([disabled])");i=v&&C(v)}a(i)}),Y(()=>{var l=t();if(te(e,l,r),r&&l===void 0){var s=e.querySelector(":checked");s!==null&&(l=C(s),a(l))}e.__value=l,r=!1}),we(e)}function ke(e,t){for(var a of e.options)a.selected=~t.indexOf(C(a))}function C(e){return"__value"in e?e.__value:e.value}const X=async({params:e})=>{const t=e.id;t||R(404);const a=await q.getTree(t);return a.status!==200&&R(404),{id:t,tree:a.data}},Ie=X?le(X):void 0,it=Object.freeze(Object.defineProperty({__proto__:null,load:Ie},Symbol.toStringTag,{value:"Module"})),xe=(e,t,a)=>{const r=e.target;q.searchSpecies(r.value).then(l=>{l.status===200&&(p(t,u(l.data)),p(a,o(t).length>0))})},$e=(e,t)=>{setTimeout(()=>{p(t,!1)},200)};var je=(e,t,a)=>t(o(a).name),Te=$('<li class="svelte-1j0o0wm"> <small class="svelte-1j0o0wm"> </small></li>'),Ce=$('<ul class="options svelte-1j0o0wm"></ul>'),Ee=$('<div class="input"><label class="svelte-1j0o0wm"><span class="svelte-1j0o0wm">Species</span> <input type="text" autocomplete="off" placeholder="Type a latin or local name" class="svelte-1j0o0wm"> <!></label> <div class="hint svelte-1j0o0wm">Enter the latin genus of the tree.</div></div>');function Oe(e,t){Z(t,!0);let a=w(t,"value",15),r=g(u([])),l=g(!1);const s=f=>{p(l,!1),a(f)};var i=Ee(),v=h(i),c=n(h(v),2);me(c),c.__input=[xe,r,l],c.__focusout=[$e,l];var _=n(c,2);{var y=f=>{var S=Ce();pe(S,21,()=>o(r),fe,(O,k)=>{var I=Te();I.__click=[je,s,k];var j=h(I),T=n(j),A=h(T);m(T),m(I),D(()=>{U(j,`${o(k).name??""} `),U(A,`~ ${o(k).local??""}`)}),x(O,I)}),m(S),x(f,S)};de(_,f=>{o(l)>0&&f(y)})}m(v),oe(2),m(i),D(()=>_e(v,"drop",o(l))),be(c,a),x(e,i),ee()}he(["input","focusout","click"]);function Ae(e,t){let a=w(t,"value",12,"");E(e,{label:"Height, m",type:"number",get value(){return a()},set value(r){a(r)},$$legacy:!0})}function De(e,t){let a=w(t,"value",12,"");E(e,{label:"Canopy diameter, m",type:"number",get value(){return a()},set value(r){a(r)},$$legacy:!0})}function qe(e,t){let a=w(t,"value",12,"");E(e,{label:"Trunk circumference, cm",type:"number",hint:"Measure at chest level, aka 120 cm from the ground.",get value(){return a()},set value(r){a(r)},$$legacy:!0})}var Fe=$('<div class="input"><label class="svelte-a4sar6"><span class="svelte-a4sar6">State</span> <select class="svelte-a4sar6"><option>(unknown)</option><option>healthy</option><option>sick</option><option>deformed</option><option>gone</option><option>stomp</option></select></label></div>');function He(e,t){let a=w(t,"value",12,"");var r=Fe(),l=h(r),s=n(h(l),2);D(()=>{a(),ne(()=>{})});var i=h(s);i.value=((i.__value="")==null,"");var v=n(i);v.value=(v.__value="healthy")==null?"":"healthy";var c=n(v);c.value=(c.__value="sick")==null?"":"sick";var _=n(c);_.value=(_.__value="deformed")==null?"":"deformed";var y=n(_);y.value=(y.__value="gone")==null?"":"gone";var f=n(y);f.value=(f.__value="stomp")==null?"":"stomp",m(s),m(l),m(r),Se(s,a),x(e,r)}function Me(e,t){let a=w(t,"value",12,"");E(e,{label:"Address",hint:"This is normally set automatically when adding a tree, but you can edit.",get value(){return a()},set value(r){a(r)},$$legacy:!0})}function Be(e,t){let a=w(t,"value",12,"");E(e,{label:"Description",multiline:!0,hint:"Add some notable details that could help visitors understand the importance of this tree.",get value(){return a()},set value(r){a(r)},$$legacy:!0})}var Pe=$('<!> <!> <!> <!> <!> <!> <!> <div class="buttons"><!> <!></div>',1),ze=$('<!> <div class="form svelte-1jizvdx"><!></div>',1);function ut(e,t){var j,T,A;Z(t,!0);const a=t.data.id;let r=g(u(t.data.tree.species??"")),l=g(u(((j=t.data.tree.height)==null?void 0:j.toString())??"0")),s=g(u(((T=t.data.tree.diameter)==null?void 0:T.toString())??"0")),i=g(u(((A=t.data.tree.circumference)==null?void 0:A.toString())??"0")),v=g(u(t.data.tree.state??"")),c=g(""),_=g(u(t.data.tree.notes??""));G(()=>{console.debug("Species changed to:",o(r))}),G(()=>{console.debug("Address changed to:",o(c))});const y=()=>{q.updateTree(a,{species:o(r),height:parseFloat(o(l)),diameter:parseFloat(o(s)),circumference:parseFloat(o(i)),state:o(v),address:o(c),notes:o(_)}).then(b=>{b.status>=200&&b.status<400?re(ve.treeDetails(a)):(console.error(`Error ${b.status} updating tree.`),K.push("Error updating tree."))}).catch(b=>{console.error(`Error updating tree: ${b}.`),K.push("Error updating tree.")})},f=()=>{history.back()};var S=ze();ie(b=>{se.title="Edit tree"});var O=J(S);ye(O,{title:"Edit tree"});var k=n(O,2),I=h(k);ce(I,{children:(b,Le)=>{var F=Pe(),H=J(F);Oe(H,{get value(){return o(r)},set value(d){p(r,u(d))}});var M=n(H,2);Ae(M,{get value(){return o(l)},set value(d){p(l,u(d))}});var B=n(M,2);De(B,{get value(){return o(s)},set value(d){p(s,u(d))}});var P=n(B,2);qe(P,{get value(){return o(i)},set value(d){p(i,u(d))}});var z=n(P,2);He(z,{get value(){return o(v)},set value(d){p(v,u(d))}});var L=n(z,2);Me(L,{get value(){return o(c)},set value(d){p(c,u(d))}});var N=n(L,2);Be(N,{get value(){return o(_)},set value(d){p(_,u(d))}});var Q=n(N,2),W=h(Q);V(W,{type:"submit",label:"Save changes",onClick:y});var ae=n(W,2);V(ae,{type:"cancel",label:"Cancel",onClick:f}),m(Q),x(b,F)},$$slots:{default:!0}}),m(k),x(e,S),ee()}export{ut as component,it as universal};
//# sourceMappingURL=10.CM7zeQ_W.js.map
