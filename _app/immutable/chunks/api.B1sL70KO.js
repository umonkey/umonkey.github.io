var d=Object.defineProperty;var g=(s,t,e)=>t in s?d(s,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):s[t]=e;var i=(s,t,e)=>g(s,typeof t!="symbol"?t+"":t,e);import{i as c,a as p}from"./auth.CKhcCp83.js";import{T as u}from"./index.DRxbb0_q.js";import"./disclose-version.DA9WmjDN.js";(function(){try{var s=typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},t=new s.Error().stack;t&&(s._sentryDebugIds=s._sentryDebugIds||{},s._sentryDebugIds[t]="95d03821-6b69-40d6-9f41-8d3133e9c060",s._sentryDebugIdIdentifier="sentry-dbid-95d03821-6b69-40d6-9f41-8d3133e9c060")}catch{}})();class y{constructor(){i(this,"root");this.root="https://yerevan.treemaps.app/",console.debug(`[api] Root: ${this.root}`)}async getTree(t){return console.debug(`[api] Getting tree ${t}`),await this.request("GET",`v1/trees/${t}`)}async getStats(){return console.debug("[api] Getting stats"),await this.request("GET","v1/trees/stats")}async getMarkers(t,e,r,a,n){const o=new URLSearchParams({n:t.toString(),e:e.toString(),s:r.toString(),w:a.toString()});return n&&o.set("search",n),await this.request("GET","v1/trees?"+o.toString())}async loginWithGoogle(t){return console.debug("[api] Logging in with Google"),await this.request("POST","v2/login/google",{body:JSON.stringify({token:t}),headers:{"Content-Type":"application/json"}})}async updateTree(t,e){return await this.request("PUT",`v1/trees/${t}`,{body:JSON.stringify(e),headers:{"Content-Type":"application/json",...this.getAuthHeaders()}})}async addComment(t,e){const r={"Content-Type":"application/json",...this.getAuthHeaders()};return await this.request("POST",`v1/trees/${t}/comments`,{body:JSON.stringify({message:e}),headers:r})}async request(t,e,r){console.debug(`[api] Requesting ${t} ${this.root}${e}`);const a=new Request(this.root+e,{method:t,...r}),n=await fetch(a),o=n.status==202?void 0:await n.json();return{status:n.status,data:o}}getAuthHeaders(){var t;if(u(c)){const e=(t=u(p))==null?void 0:t.token;if(e)return{Authorization:`Bearer ${e}`}}return{}}}const b=new y;export{b as a};
//# sourceMappingURL=api.B1sL70KO.js.map
